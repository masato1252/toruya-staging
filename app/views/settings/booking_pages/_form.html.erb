<%
  page_booking_options = @booking_page.booking_options.map do |option|
    booking_option_item(option)
  end
%>

<div id="settingForm">
  <%= react_component("management/settings/booking/booking_page_settings", {
    form_authenticity_token: form_authenticity_token,
    booking_page: @booking_page.attributes,
    shop_options: shop_options(super_user.shops.order("id")),
    timezone: Time.zone.tzinfo.name,
    booking_page: @booking_page.attributes.merge!(
      interval: @booking_page.interval || 30,
      start_at_type: @booking_page.start_at ? "date" : "now",
      start_at_date_part: @booking_page.start_at_date || Date.current.to_s,
      start_at_time_part: @booking_page.start_at_time,
      end_at_type: @booking_page.end_at ? "date" : "now",
      end_at_date_part: @booking_page.end_at_date || Date.current.to_s,
      end_at_time_part: @booking_page.end_at_time,
      available_booking_options: [],
      options: custom_options(page_booking_options),
      had_special_date: @booking_page.booking_page_special_dates.exists?,
      special_dates: @booking_page.booking_page_special_dates.map do |special_date|
        {
          start_at_date_part: special_date.start_at_date,
          start_at_time_part: special_date.start_at_time,
          end_at_date_part:   special_date.end_at_date,
          end_at_time_part:   special_date.end_at_time
        }
      end
    ),
    calendar: {
      dayNames: I18n.t("date.abbr_day_names"),
      monthNames: I18n.t("date.abbr_month_names").compact,
      schedulePath: booking_page_settings_calendars_path(format: :json)
    },
    path: {
      cancel: settings_user_booking_pages_path(super_user),
      save: @booking_page.new_record? ? settings_user_booking_pages_path(super_user) : settings_user_booking_page_path(super_user, @booking_page),
      validate_special_dates: validate_special_dates_settings_user_booking_pages_path(super_user),
      business_time: business_time_settings_user_booking_pages_path(super_user),
      booking_options: booking_options_settings_user_booking_pages_path(super_user)
    },
    i18n: {
      errors: t("errors.messages").slice(:required),
    }.merge!([
      t("settings.booking_page.form"),
      t("common").slice(:required_label, :select_a_booking_option, :minute, :time),
      t("action").slice(:cancel, :add_more, :save_as_draft, :save_and_publish)
    ].inject(:merge!)
    ),
  },
  { camelize_props: false }
  ) %>
</div>
