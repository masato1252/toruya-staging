<%= react_component("user_bot/sales/booking_page_creation_flow", {
  props: {
    sale_page: @sale_page&.merge!(
      selected_booking_page: @selected_booking_page,
      selected_template: @selected_template,
    ),
    selected_booking_page: @selected_booking_page,
    business_owner_id: business_owner_id,
    social_account_add_friend_url: Current.business_owner.social_accounts.first&.add_friend_url,
    booking_pages: Current.business_owner.booking_pages.select {|page| page.primary_product }.map { |b|
      {
        label: b.name,
        value: BookingPageSerializer.new(b).attributes_hash
      }
    },
    staffs: Current.business_owner.staffs.includes(picture_attachment: :blob).map { |staff|
      {
        label: staff.name,
        value: StaffSerializer.new(staff).attributes_hash
      }
    },
    sale_templates: @sale_templates.map.with_index { |template, index| SaleTemplateSerializer.new(template).attributes_hash.merge(position: index + 1) },
    flow_tips: I18n.t("user_bot.dashboards.sales.booking_page_creation.flow_tips"),
    shops: Current.business_owner.shops.includes({ logo_attachment: :blob }).inject({}) { |h, s| h[s.id] = CompanyInfoSerializer.new(s).attributes_hash; h },
    support_feature_flags: support_feature_flags,
  }
},
{ camelize_props: false }
) if ability(current_user).can?(:create, SalePage) %>
