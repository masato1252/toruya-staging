<div class="payments form">
  <div class="top-navigation-bar">
    <%= link_to lines_user_bot_settings_dashboard_path do %>
      <i class="fa fa-angle-left fa-2x"></i>
    <% end %>
      <span><%= t("user_bot.dashboards.settings.dashboard.payments_label") %></span>
    <i></i>
  </div>

  <%= flash_messages %>
  <table class="history">
    <thead>
      <tr>
        <th class="charge-date"><%= t("settings.plans.payment.date") %></th>
        <th class="charge-amount"><%= t("settings.plans.payment.amount") %></th>
        <th class="charge-plan"><%= t("settings.plans.payment.plan") %></th>
        <th class="charge-receipt"><%= t("settings.plans.payment.receipt") %></th>
      </tr>
    </thead>
    <tbody>
      <% @charges.each do |charge| %>
      <tr>
        <td><%= l(charge.created_at.to_date) %></td>
        <td><%= charge.amount.format %></td>
        <td><%= charge_description(charge) %> <%= "(#{t("settings.plans.payment.refund")})" if charge.refunded? %></td>
        <td>
          <%= link_to t("settings.plans.payment.receipt"), receipt_lines_user_bot_settings_payment_path(charge, format: :pdf), target: "_blank" %>
          <%= link_to t("settings.plans.payment.refund"), "#", class: "btn btn-orange", data: { toggle: "modal", target: "#refund-modal" } if @refundable && @subscription.first_charge.id == charge.id %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>

  <% if @refundable %>
    <div class="modal fade" id="refund-modal" tabIndex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content refund-area">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">Ã—</span>
            </button>
            <h4 class="modal-title">
              <%= t("settings.plans.refund.modal_title") %>
            </h4>
          </div>
          <div class="modal-body">
            <div>
              <%= t("settings.plans.refund.desc") %>
            </div>
            <div class="refund-label">
              <%= t("settings.plans.refund.label1") %>
            </div>
            <div>
              <%= t("settings.plans.refund.desc1") %>
            </div>
            <div class="refund-label">
              <%= t("settings.plans.refund.label2") %>
            </div>
            <div>
              <%= t("settings.plans.refund.desc1") %>
            </div>
          </div>
          <div class="modal-footer">
            <%= link_to t("settings.plans.refund.cancel_btn"), '#', class: "btn btn-tarco", data: { dismiss: "modal" } %>
            <%= link_to t("settings.plans.refund.confirm_btn"), refund_lines_user_bot_settings_payments_path, class: "btn btn-orange" %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
